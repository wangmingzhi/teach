webpackJsonp([8],{dnIv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("oFuF"),l=a("E4LH"),i=a("1onU"),r=a("vLgD"),o=function(e){return Object(r.b)("/api/admin/class/page/list",e)},n=function(e){return Object(r.b)("/api/admin/class/edit",e)},c=function(e){return Object(r.b)("/api/admin/class/select/"+e)},d=function(e){return Object(r.b)("/api/admin/class/delete/"+e)},u=function(e){return Object(r.b)("/api/admin/student/page/list",e)},m=function(e){return Object(r.b)("/api/admin/student/edit",e)},p=function(e){return Object(r.b)("/api/admin/student/select/"+e)},f=function(e){return Object(r.b)("/api/admin/student/delete/"+e)},b=function(e){return Object(r.b)("/api/admin/student/changeStatus/"+e)},h={components:{Pagination:i.a},data:function(){return{classParam:{areaType:"",className:"",pageIndex:1,pageSize:5},query:{areaType:"",pageIndex:1,pageSize:5},studentParam:{areaType:"",className:"",pageIndex:1,pageSize:5},areaTypeOptions:[],sexEnum:s.f,isOptions:s.e,classOptions:[],classOptions2:[],dialogClassVisible:!1,classForm:{classId:null},dicForm:{studentId:null},selectType:"",selectClass:"",listLoading:!0,dicLoading:!1,classData:[],dicData:[],total:0,dicTotal:0,dialogTypeVisible:!1,dialogDicVisible:!1,newForm:!1,formLabelWidth:"80px",rules:{areaType:[{required:!0,message:"请选择区域",trigger:"blur"}],className:[{required:!0,message:"请输入班级名称",trigger:"blur"}],studentName:[{required:!0,message:"请输入学员姓名",trigger:"blur"}],phoneNo:[{required:!0,validator:l.b,trigger:"blur"}],email:[{required:!1,validator:l.c,trigger:"blur"}],wechat:[{required:!0,message:"请输入微信号",trigger:"blur"}]}}},created:function(){this.init(),this.searchClass(),this.searchDic()},methods:{init:function(){var e=this;Object(s.d)("AREA_TYPE_CODE",function(t){e.areaTypeOptions=t})},searchClass:function(){var e=this;o(this.classParam).then(function(t){var a=t.response;e.classData=a.list,e.total=a.total,e.classParam.pageIndex=a.pageNum,e.listLoading=!1})},searchDic:function(){var e=this;u(this.studentParam).then(function(t){var a=t.response;e.dicData=a.list,e.dicTotal=a.total,e.studentParam.pageIndex=a.pageNum,e.dicLoading=!1})},typeRowClick:function(e,t,a){if(this.selectType=e.areaType,this.selectClass=e.classId,this.studentParam.classId===e.classId);else{this.studentParam.areaType=e.areaType;var s=this;this.initClassOptions(e.areaType,function(t){s.classOptions=t.list,s.studentParam.classId=e.classId,s.searchDic()})}},initClassOptions:function(e,t){this.query.areaType=e,this.query.pageIndex=1,this.query.pageSize=1e3,o(this.query).then(function(e){var a=e.response;t(a)})},changeStatus:function(e){var t=this;b(e.studentId).then(function(a){1===a.code?(e.isAuthorize=a.response,t.$message.success(a.message)):t.$message.error(a.message)})},areaTypeChange:function(e){var t=this;t.studentParam.classId=null,e?t.initClassOptions(e,function(e){t.classOptions=e.list}):t.classOptions=[]},areaTypeChange2:function(e){var t=this;e?t.initClassOptions(e,function(e){t.classOptions2=e.list}):t.classOptions2=[]},classChange:function(e){this.$forceUpdate()},createClass:function(){this.classForm={classId:null,areaType:"",className:""},this.dialogClassVisible=!0,this.$refs.classForm.resetFields()},createStudent:function(){if(this.selectType){var e=new Date;e.setMonth(e.getMonth()+10);var t=Object(s.a)(e);this.newForm=!1,this.dicForm={studentId:null,areaType:this.selectType,classId:this.selectClass,studentName:"",phoneNo:"",expiryDate:t,isAuthorize:"0"},this.dialogDicVisible=!0,this.$refs.dicForm.resetFields()}else this.$message({message:"请选择班级",type:"warning"})},editClass:function(e){var t=this;this.formLoading=!0,c(e.classId).then(function(e){t.classForm=e.response,t.formLoading=!1,t.dialogClassVisible=!0})},editDic:function(e){var t=this;this.newForm=!1,this.formLoading=!0,p(e.studentId).then(function(e){t.dicForm=e.response,t.formLoading=!1,t.dialogDicVisible=!0,t.areaTypeChange2(t.dicForm.areaType)})},deleteClass:function(e){var t=this;t.dicTotal>0?t.$message.error("班级有学员，无法删除"):d(e.classId).then(function(e){1===e.code?(t.searchClass(),t.$message.success(e.message)):t.$message.error(e.message)})},deleteDic:function(e){var t=this;f(e.studentId).then(function(e){1===e.code?(t.searchDic(),t.$message.success(e.message)):t.$message.error(e.message)})},submitclassForm:function(){var e=this,t=this;this.$refs.classForm.validate(function(a){if(!a)return!1;e.formLoading=!0,n(e.classForm).then(function(e){1===e.code?(t.$message.success(e.message),t.dialogClassVisible=!1,t.searchClass()):(t.$message.error(e.message),t.formLoading=!1)}).catch(function(e){t.formLoading=!1})})},submitDicForm:function(){var e=this,t=this;this.$refs.dicForm.validate(function(a){if(!a)return!1;e.formLoading=!0,m(e.dicForm).then(function(e){1===e.code?(t.$message.success(e.message),t.dialogDicVisible=!1,t.searchDic()):(t.$message.error(e.message),t.formLoading=!1)}).catch(function(e){t.formLoading=!1})})},areaTypeFormatter:function(e,t,a,l){return Object(s.b)(this.areaTypeOptions,a)},isAuthorizeFormatter:function(e,t,a,l){return Object(s.c)(s.e,a)},sexFormatter:function(e,t,a,l){return Object(s.c)(s.f,a)}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"classForm",attrs:{model:e.classForm,inline:!0}},[a("el-form-item",{attrs:{label:"地区："}},[a("el-select",{attrs:{clearable:""},model:{value:e.classParam.areaType,callback:function(t){e.$set(e.classParam,"areaType",t)},expression:"classParam.areaType"}},e._l(e.areaTypeOptions,function(e){return a("el-option",{key:e.dictionaryCode,attrs:{label:e.dictionaryName,value:e.dictionaryCode}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"名称："}},[a("el-input",{model:{value:e.classParam.className,callback:function(t){e.$set(e.classParam,"className",t)},expression:"classParam.className"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchClass}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-document-add"},on:{click:e.createClass}},[e._v("新增")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"classTable",staticStyle:{width:"100%"},attrs:{data:e.classData,border:"",fit:"","highlight-current-row":""},on:{"row-click":e.typeRowClick}},[a("el-table-column",{attrs:{prop:"areaType",label:"地区",formatter:e.areaTypeFormatter}}),e._v("/>\r\n        "),a("el-table-column",{attrs:{prop:"className",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createUser",label:"录入人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"录入时间"}}),e._v(" "),a("el-table-column",{attrs:{width:"290px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("el-button",{staticClass:"link-left",attrs:{size:"mini",type:"primary",plain:"",icon:"el-icon-edit"},on:{click:function(t){return e.editClass(s)}}},[e._v("修改")]),e._v(" "),a("el-popconfirm",{attrs:{title:"确定删除吗？",iconColor:"red"},on:{onConfirm:function(t){return e.deleteClass(s)}}},[a("el-button",{staticClass:"link-left",attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.classParam.pageIndex,limit:e.classParam.pageSize},on:{"update:page":function(t){return e.$set(e.classParam,"pageIndex",t)},"update:limit":function(t){return e.$set(e.classParam,"pageSize",t)},pagination:e.searchClass}})],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"studentForm",attrs:{model:e.studentParam,inline:!0}},[a("el-form-item",{attrs:{label:"地区："}},[a("el-select",{attrs:{clearable:""},on:{change:e.areaTypeChange},model:{value:e.studentParam.areaType,callback:function(t){e.$set(e.studentParam,"areaType",t)},expression:"studentParam.areaType"}},e._l(e.areaTypeOptions,function(e){return a("el-option",{key:e.dictionaryCode,attrs:{label:e.dictionaryName,value:e.dictionaryCode}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"班级："}},[a("el-select",{attrs:{clearable:""},on:{change:e.classChange},model:{value:e.studentParam.classId,callback:function(t){e.$set(e.studentParam,"classId",t)},expression:"studentParam.classId"}},e._l(e.classOptions,function(e){return a("el-option",{key:e.classId,attrs:{label:e.className,value:e.classId}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名："}},[a("el-input",{model:{value:e.studentParam.studentName,callback:function(t){e.$set(e.studentParam,"studentName",t)},expression:"studentParam.studentName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号："}},[a("el-input",{model:{value:e.studentParam.phoneNo,callback:function(t){e.$set(e.studentParam,"phoneNo",t)},expression:"studentParam.phoneNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"微信号："}},[a("el-input",{model:{value:e.studentParam.wechat,callback:function(t){e.$set(e.studentParam,"wechat",t)},expression:"studentParam.wechat"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"有效期："}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.studentParam.expiryDate,callback:function(t){e.$set(e.studentParam,"expiryDate",t)},expression:"studentParam.expiryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"授权："}},[a("el-select",{attrs:{clearable:""},model:{value:e.studentParam.isAuthorize,callback:function(t){e.$set(e.studentParam,"isAuthorize",t)},expression:"studentParam.isAuthorize"}},e._l(e.isOptions,function(e){return a("el-option",{key:e.key,attrs:{label:e.value,value:e.key}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱："}},[a("el-input",{model:{value:e.studentParam.email,callback:function(t){e.$set(e.studentParam,"email",t)},expression:"studentParam.email"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchDic}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-document-add"},on:{click:e.createStudent}},[e._v("新增")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"typeTable",staticStyle:{width:"100%"},attrs:{data:e.dicData,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"studentName",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",formatter:e.sexFormatter,width:"50px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phoneNo",label:"手机号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"wechat",label:"微信号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"company",label:"企业","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"expiryDate",label:"有效期",width:"100px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"isAuthorize",label:"授权",formatter:e.isAuthorizeFormatter,width:"50px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createUser",label:"录入人"}}),e._v(" "),a("el-table-column",{attrs:{width:"290px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("el-button",{staticClass:"link-left",attrs:{size:"mini",type:"1"==s.isAuthorize?"info":"success",plain:"",icon:"1"==s.isAuthorize?"el-icon-lock":"el-icon-key"},on:{click:function(t){return e.changeStatus(s)}}},[e._v("\r\n              "+e._s("1"==s.isAuthorize?"取消":"授权"))]),e._v(" "),a("el-button",{staticClass:"link-left",attrs:{size:"mini",type:"primary",plain:"",icon:"el-icon-edit"},on:{click:function(t){return e.editDic(s)}}},[e._v("修改")]),e._v(" "),a("el-popconfirm",{attrs:{title:"确定删除吗？",iconColor:"red"},on:{onConfirm:function(t){return e.deleteDic(s)}}},[a("el-button",{staticClass:"link-left",attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.dicTotal>0,expression:"dicTotal>0"}],attrs:{total:e.dicTotal,page:e.studentParam.pageIndex,limit:e.studentParam.pageSize},on:{"update:page":function(t){return e.$set(e.studentParam,"pageIndex",t)},"update:limit":function(t){return e.$set(e.studentParam,"pageSize",t)},pagination:e.searchDic}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"班级编辑",visible:e.dialogClassVisible},on:{"update:visible":function(t){e.dialogClassVisible=t}}},[a("el-form",{ref:"classForm",attrs:{model:e.classForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"地区：","label-width":e.formLabelWidth,prop:"areaType",required:""}},[a("el-select",{attrs:{clearable:""},model:{value:e.classForm.areaType,callback:function(t){e.$set(e.classForm,"areaType",t)},expression:"classForm.areaType"}},e._l(e.areaTypeOptions,function(e){return a("el-option",{key:e.dictionaryCode,attrs:{label:e.dictionaryName,value:e.dictionaryCode}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"名称:","label-width":e.formLabelWidth,prop:"className",required:""}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.classForm.className,callback:function(t){e.$set(e.classForm,"className",t)},expression:"classForm.className"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogClassVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitclassForm}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"学员编辑",visible:e.dialogDicVisible,width:"50%"},on:{"update:visible":function(t){e.dialogDicVisible=t}}},[a("el-form",{ref:"dicForm",attrs:{model:e.dicForm,rules:e.rules}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"地区：","label-width":e.formLabelWidth}},[a("el-select",{attrs:{disabled:e.newForm,clearable:""},on:{change:e.areaTypeChange2},model:{value:e.dicForm.areaType,callback:function(t){e.$set(e.dicForm,"areaType",t)},expression:"dicForm.areaType"}},e._l(e.areaTypeOptions,function(e){return a("el-option",{key:e.dictionaryCode,attrs:{label:e.dictionaryName,value:e.dictionaryCode}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"班级：","label-width":e.formLabelWidth}},[a("el-select",{attrs:{disabled:e.newForm,clearable:""},model:{value:e.dicForm.classId,callback:function(t){e.$set(e.dicForm,"classId",t)},expression:"dicForm.classId"}},e._l(e.classOptions2,function(e){return a("el-option",{key:e.classId,attrs:{label:e.className,value:e.classId}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"姓名：","label-width":e.formLabelWidth,prop:"studentName",required:""}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dicForm.studentName,callback:function(t){e.$set(e.dicForm,"studentName",t)},expression:"dicForm.studentName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"性别：","label-width":e.formLabelWidth}},[a("el-select",{attrs:{clearable:""},model:{value:e.dicForm.sex,callback:function(t){e.$set(e.dicForm,"sex",t)},expression:"dicForm.sex"}},e._l(e.sexEnum,function(e){return a("el-option",{key:e.key,attrs:{label:e.value,value:e.key}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"微信号：","label-width":e.formLabelWidth,prop:"wechat",required:""}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dicForm.wechat,callback:function(t){e.$set(e.dicForm,"wechat",t)},expression:"dicForm.wechat"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"手机号：","label-width":e.formLabelWidth,prop:"phoneNo",required:""}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dicForm.phoneNo,callback:function(t){e.$set(e.dicForm,"phoneNo",t)},expression:"dicForm.phoneNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"邮箱：","label-width":e.formLabelWidth,prop:"email"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dicForm.email,callback:function(t){e.$set(e.dicForm,"email",t)},expression:"dicForm.email"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"企业：","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dicForm.company,callback:function(t){e.$set(e.dicForm,"company",t)},expression:"dicForm.company"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"授权：","label-width":e.formLabelWidth}},[a("el-select",{attrs:{clearable:""},model:{value:e.dicForm.isAuthorize,callback:function(t){e.$set(e.dicForm,"isAuthorize",t)},expression:"dicForm.isAuthorize"}},e._l(e.isOptions,function(e){return a("el-option",{key:e.key,attrs:{label:e.value,value:e.key}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"有效期：","label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.dicForm.expiryDate,callback:function(t){e.$set(e.dicForm,"expiryDate",t)},expression:"dicForm.expiryDate"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogDicVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitDicForm}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]},g=a("VU/8")(h,v,!1,null,null,null);t.default=g.exports}});
//# sourceMappingURL=8.96ca65421ccf674375d1.js.map