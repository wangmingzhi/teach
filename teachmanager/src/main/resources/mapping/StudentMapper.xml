<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.teachpmp.server.dao.StudentMapper">
  <resultMap id="BaseResultMap" type="com.teachpmp.server.entity.Student">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Feb 15 14:32:43 CST 2020.
    -->
    <id column="student_id" jdbcType="VARCHAR" property="studentId" />
    <result column="class_id" jdbcType="VARCHAR" property="classId" />
    <result column="area_type" jdbcType="VARCHAR" property="areaType" />
    <result column="company" jdbcType="VARCHAR" property="company" />
    <result column="student_name" jdbcType="VARCHAR" property="studentName" />
    <result column="sex" jdbcType="CHAR" property="sex" />
    <result column="phone_no" jdbcType="VARCHAR" property="phoneNo" />
    <result column="email" jdbcType="VARCHAR" property="email" />
    <result column="wechat" jdbcType="VARCHAR" property="wechat" />
    <result column="expiry_date" jdbcType="TIMESTAMP" property="expiryDate" />
    <result column="is_authorize" jdbcType="CHAR" property="isAuthorize" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="update_user" jdbcType="VARCHAR" property="updateUser" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="create_user" jdbcType="VARCHAR" property="createUser" />
    <result column="openid" jdbcType="VARCHAR" property="openid" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Feb 15 14:32:43 CST 2020.
    -->
    delete from tb_student_info
    where student_id = #{studentId,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.teachpmp.server.entity.Student">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Feb 15 14:32:43 CST 2020.
    -->
    insert into tb_student_info (student_id, class_id, area_type,company,
      student_name, sex, phone_no,
      email, wechat, expiry_date,
      is_authorize, create_time, update_user,
      update_time, create_user,openid)
    values (#{studentId,jdbcType=VARCHAR}, #{classId,jdbcType=VARCHAR}, #{areaType,jdbcType=VARCHAR},#{company,jdbcType=VARCHAR},
      #{studentName,jdbcType=VARCHAR}, #{sex,jdbcType=CHAR}, #{phoneNo,jdbcType=VARCHAR},
      #{email,jdbcType=VARCHAR}, #{wechat,jdbcType=VARCHAR}, #{expiryDate,jdbcType=TIMESTAMP},
      #{isAuthorize,jdbcType=CHAR}, #{createTime,jdbcType=TIMESTAMP}, #{updateUser,jdbcType=VARCHAR},
      #{updateTime,jdbcType=TIMESTAMP}, #{createUser,jdbcType=VARCHAR}, #{openid,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.teachpmp.server.entity.Student">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Feb 15 14:32:43 CST 2020.
    -->
    update tb_student_info
    set class_id = #{classId,jdbcType=VARCHAR},
      area_type = #{areaType,jdbcType=VARCHAR},
      company = #{company,jdbcType=VARCHAR},
      student_name = #{studentName,jdbcType=VARCHAR},
      sex = #{sex,jdbcType=CHAR},
      phone_no = #{phoneNo,jdbcType=VARCHAR},
      email = #{email,jdbcType=VARCHAR},
      wechat = #{wechat,jdbcType=VARCHAR},
      expiry_date = #{expiryDate,jdbcType=TIMESTAMP},
      is_authorize = #{isAuthorize,jdbcType=CHAR},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      update_user = #{updateUser,jdbcType=VARCHAR},
      update_time = #{updateTime,jdbcType=TIMESTAMP},
      create_user = #{createUser,jdbcType=VARCHAR},
      openid = #{openid,jdbcType=VARCHAR}
    where student_id = #{studentId,jdbcType=VARCHAR}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Feb 15 14:32:43 CST 2020.
    -->
    select student_id, class_id, area_type,company, student_name, sex, phone_no, email, wechat,
    expiry_date, is_authorize, create_time, update_user, update_time, create_user,openid
    from tb_student_info
    where student_id = #{studentId,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Feb 15 14:32:43 CST 2020.
    -->
    select student_id, class_id, area_type,company, student_name, sex, phone_no, email, wechat,
    expiry_date, is_authorize, create_time, update_user, update_time, create_user,openid
    from tb_student_info
  </select>
  <select id="page" resultMap="BaseResultMap" parameterType="com.teachpmp.server.entity.ClassInfo">
    select student_id, class_id, area_type,company, student_name, sex, phone_no, email, wechat,
    expiry_date, is_authorize, create_time, update_user, update_time, create_user,openid
    from tb_student_info
    <where>
      <if test="areaType != null and areaType != ''">
        and area_type=#{areaType}
      </if>
      <if test="classId != null and classId != ''">
        and class_id=#{classId}
      </if>
      <if test="studentName != null and studentName != ''">
        and student_name like concat('%',#{studentName},'%')
      </if>
      <if test="phoneNo != null and phoneNo != ''">
      and phone_no like concat('%',#{phoneNo},'%')
    </if>
      <if test="wechat != null and wechat != ''">
        and wechat like concat('%',#{wechat},'%')
      </if>
      <if test="email != null and email != ''">
        and email like concat('%',#{email},'%')
      </if>
      <if test="expiryDate != null">
        and expiry_date &gt;= #{expiryDate}
      </if>
      <if test="isAuthorize != null and isAuthorize != ''">
        and is_authorize = #{isAuthorize}
      </if>
    </where>
  </select>
  <select id="selectOne" resultMap="BaseResultMap" parameterType="com.teachpmp.server.entity.Student">
    select student_id, class_id, area_type,company, student_name, sex, phone_no, email, wechat,
    expiry_date, is_authorize, create_time, update_user, update_time, create_user,openid
    from tb_student_info
    <where>
      <choose>
        <when test="openid != null and openid != ''">
          and openid = #{openid}
        </when>
        <otherwise>
          <if test="phoneNo != null and phoneNo != ''">
            and phone_no = #{phoneNo}
          </if>
          <if test="classId != null and classId != ''">
            and class_id = #{classId}
          </if>
        </otherwise>
      </choose>
  </where>
  </select>
  <select id="countStudent" resultType="java.lang.Integer">
    select count(1)
    from tb_student_info
  </select>
  <update id="deleteClass" parameterType="java.lang.String">
    update tb_student_info set class_id = null where class_id=#{classId}
  </update>
</mapper>